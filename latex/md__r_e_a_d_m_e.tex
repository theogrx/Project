\chapter{Project Documentation\+: Country Information API}
\hypertarget{md__r_e_a_d_m_e}{}\label{md__r_e_a_d_m_e}\index{Project Documentation: Country Information API@{Project Documentation: Country Information API}}
\label{md__r_e_a_d_m_e_autotoc_md0}%
\Hypertarget{md__r_e_a_d_m_e_autotoc_md0}%
\hypertarget{md__r_e_a_d_m_e_autotoc_md1}{}\doxysection{\texorpdfstring{Overview}{Overview}}\label{md__r_e_a_d_m_e_autotoc_md1}
The {\bfseries{Country Information API}} is a RESTful service that provides country-\/related information, including data about country names, borders, and capitals. The API fetches data either from an external source (via an API) or from a local database and caches the results for performance improvements. The service supports fetching country details, storing them in a local database (SQL Server), and caching the results to minimize redundant API calls.\hypertarget{md__r_e_a_d_m_e_autotoc_md2}{}\doxysection{\texorpdfstring{Key Components}{Key Components}}\label{md__r_e_a_d_m_e_autotoc_md2}

\begin{DoxyItemize}
\item {\bfseries{Controllers}}\+: Handle incoming HTTP requests and interact with the {\ttfamily Country\+Helper} service to fetch and return country data.
\item {\bfseries{Country\+Helper}}\+: Contains the logic for fetching country data either from the external API or local database. It also handles caching.
\item {\bfseries{Application\+Db\+Context}}\+: Entity Framework Db\+Context used to interact with the SQL Server database.
\item {\bfseries{Custom\+Memory\+Cache}}\+: A custom caching mechanism that stores country data in memory.
\item {\bfseries{Models}}\+: Defines the structure of the country data and DTOs used in API responses.
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md3}{}\doxysection{\texorpdfstring{Technologies}{Technologies}}\label{md__r_e_a_d_m_e_autotoc_md3}

\begin{DoxyItemize}
\item {\bfseries{.NET 8}}\+: The application is built using the .NET framework, with dependency injection and middleware to handle requests and responses.
\item {\bfseries{Entity Framework Core}}\+: ORM (Object Relational Mapper) to interact with a SQL Server database.
\item {\bfseries{SQL Server 2022}}\+: The database used for storing country data.
\item {\bfseries{External REST API (e.\+g., Rest\+Countries API)}}\+: Data is fetched from an external API for country information when necessary.
\item {\bfseries{Custom Memory Cache}}\+: Used to store and retrieve country data to optimize API calls.
\item {\bfseries{Postman/\+Swagger}}\+: Used for testing and interacting with the API.
\end{DoxyItemize}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md5}{}\doxysection{\texorpdfstring{Project Structure}{Project Structure}}\label{md__r_e_a_d_m_e_autotoc_md5}
\hypertarget{md__r_e_a_d_m_e_autotoc_md6}{}\doxysubsection{\texorpdfstring{Controllers}{Controllers}}\label{md__r_e_a_d_m_e_autotoc_md6}
\hypertarget{md__r_e_a_d_m_e_autotoc_md7}{}\doxysubsubsection{\texorpdfstring{Country\+Controller}{Country\+Controller}}\label{md__r_e_a_d_m_e_autotoc_md7}

\begin{DoxyItemize}
\item {\bfseries{Route}}\+: {\ttfamily /api/country}
\item {\bfseries{Methods}}\+:
\begin{DoxyItemize}
\item {\ttfamily GET}\+: Fetches the list of countries. Returns cached data if available, or fetches fresh data from the API and stores it in the database and cache.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md8}{}\doxysubsubsection{\texorpdfstring{Example\+:}{Example\+:}}\label{md__r_e_a_d_m_e_autotoc_md8}
{\bfseries{GET /api/country}}


\begin{DoxyCode}{0}
\DoxyCodeLine{[}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}name"{}:\ "{}United\ States"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}borders"{}:\ ["{}Canada"{},\ "{}Mexico"{}],}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}capital"{}:\ ["{}Washington,\ D.C."{}]}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}name"{}:\ "{}Canada"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}borders"{}:\ ["{}United\ States"{}],}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}capital"{}:\ ["{}Ottawa"{}]}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{]}

\end{DoxyCode}
\hypertarget{md__r_e_a_d_m_e_autotoc_md9}{}\doxysubsection{\texorpdfstring{Services}{Services}}\label{md__r_e_a_d_m_e_autotoc_md9}
\hypertarget{md__r_e_a_d_m_e_autotoc_md10}{}\doxysubsubsection{\texorpdfstring{Country\+Helper}{Country\+Helper}}\label{md__r_e_a_d_m_e_autotoc_md10}

\begin{DoxyItemize}
\item Responsible for interacting with the external API, caching the data, and interacting with the database.
\item {\bfseries{Methods}}\+:
\begin{DoxyItemize}
\item {\ttfamily Fetch\+Countries\+Async()}\+: Fetches country data either from the cache, the database, or the external API and saves it to the database and cache.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md11}{}\doxysubsubsection{\texorpdfstring{Custom\+Memory\+Cache}{Custom\+Memory\+Cache}}\label{md__r_e_a_d_m_e_autotoc_md11}

\begin{DoxyItemize}
\item A simple custom caching service used to store data in memory for quick access.
\item {\bfseries{Methods}}\+:
\begin{DoxyItemize}
\item {\ttfamily Try\+Get\+Value\texorpdfstring{$<$}{<}T\texorpdfstring{$>$}{>}(string key, out T value)}\+: Checks if a cache entry exists for a given key.
\item {\ttfamily Set(string key, object value)}\+: Stores data in the cache with the specified key.
\item {\ttfamily Remove(string key)}\+: Removes an item from the cache.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{md__r_e_a_d_m_e_autotoc_md12}{}\doxysubsubsection{\texorpdfstring{Application\+Db\+Context}{Application\+Db\+Context}}\label{md__r_e_a_d_m_e_autotoc_md12}

\begin{DoxyItemize}
\item Represents the connection to the database and is used for interacting with the {\ttfamily Countries} table.
\item {\bfseries{Tables}}\+:
\begin{DoxyItemize}
\item {\ttfamily Countries}\+: Stores country data with information like country name, borders, and capital.
\end{DoxyItemize}
\end{DoxyItemize}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md14}{}\doxysection{\texorpdfstring{Database Schema}{Database Schema}}\label{md__r_e_a_d_m_e_autotoc_md14}
\hypertarget{md__r_e_a_d_m_e_autotoc_md15}{}\doxysubsection{\texorpdfstring{Countries Table}{Countries Table}}\label{md__r_e_a_d_m_e_autotoc_md15}

\begin{DoxyItemize}
\item {\bfseries{Columns}}\+:
\begin{DoxyItemize}
\item {\ttfamily Id} (int)\+: Primary key, unique identifier for each country.
\item {\ttfamily Name} (string)\+: The name of the country.
\item {\ttfamily Borders} (List$<$string$>$)\+: A list of country names that the country shares borders with.
\item {\ttfamily Capital} (List$<$string$>$)\+: A list of capitals for the country.
\end{DoxyItemize}
\end{DoxyItemize}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md17}{}\doxysection{\texorpdfstring{App\+Settings Configuration}{App\+Settings Configuration}}\label{md__r_e_a_d_m_e_autotoc_md17}
\hypertarget{md__r_e_a_d_m_e_autotoc_md18}{}\doxysubsection{\texorpdfstring{appsettings.\+json}{appsettings.\+json}}\label{md__r_e_a_d_m_e_autotoc_md18}
The application relies on the {\ttfamily appsettings.\+json} file for configuration, particularly for the API settings and database connection string.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}ApiSettings"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}RestCountriesUrl"{}:\ "{}https://restcountries.com/v3.1/all"{}}
\DoxyCodeLine{\ \ \},}
\DoxyCodeLine{\ \ "{}ConnectionStrings"{}:\ \{}
\DoxyCodeLine{\ \ \ \ "{}Project"{}:\ "{}Data\ Source=(local);Initial\ Catalog=Project;Integrated\ Security=True;Encrypt=False"{}}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md__r_e_a_d_m_e_autotoc_md19}{}\doxysubsection{\texorpdfstring{Key Settings\+:}{Key Settings\+:}}\label{md__r_e_a_d_m_e_autotoc_md19}

\begin{DoxyItemize}
\item {\bfseries{Rest\+Countries\+Url}}\+: URL of the external API to fetch country data.
\item {\bfseries{Connection\+Strings.\+Project}}\+: SQL Server connection string used by the application.
\end{DoxyItemize}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md21}{}\doxysection{\texorpdfstring{API Endpoints}{API Endpoints}}\label{md__r_e_a_d_m_e_autotoc_md21}
\hypertarget{md__r_e_a_d_m_e_autotoc_md22}{}\doxysubsection{\texorpdfstring{GET /api/country}{GET /api/country}}\label{md__r_e_a_d_m_e_autotoc_md22}
Fetches the list of countries. This endpoint will first check the cache for the requested data. If the data isn\textquotesingle{}t available, it will fetch the data from the external API and store it in the database and cache.\hypertarget{md__r_e_a_d_m_e_autotoc_md23}{}\doxysubsubsection{\texorpdfstring{Request\+:}{Request\+:}}\label{md__r_e_a_d_m_e_autotoc_md23}

\begin{DoxyCode}{0}
\DoxyCodeLine{GET\ /api/country}

\end{DoxyCode}
\hypertarget{md__r_e_a_d_m_e_autotoc_md24}{}\doxysubsubsection{\texorpdfstring{Response\+:}{Response\+:}}\label{md__r_e_a_d_m_e_autotoc_md24}

\begin{DoxyItemize}
\item {\bfseries{200 OK}}\+: A JSON array containing the country data, including names, borders, and capitals.
\item {\bfseries{400 Bad\+Request}}\+: In case of an error or no countries found.
\end{DoxyItemize}

Example response\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{[}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}name"{}:\ "{}United\ States"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}borders"{}:\ ["{}Canada"{},\ "{}Mexico"{}],}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}capital"{}:\ ["{}Washington,\ D.C."{}]}
\DoxyCodeLine{\ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}name"{}:\ "{}Canada"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}borders"{}:\ ["{}United\ States"{}],}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}capital"{}:\ ["{}Ottawa"{}]}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{]}

\end{DoxyCode}


\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md26}{}\doxysection{\texorpdfstring{Dependencies}{Dependencies}}\label{md__r_e_a_d_m_e_autotoc_md26}

\begin{DoxyEnumerate}
\item {\bfseries{Http\+Client}}\+:
\begin{DoxyItemize}
\item Used to make requests to the external Rest\+Countries API to fetch country data.
\end{DoxyItemize}
\item {\bfseries{Db\+Context (Application\+Db\+Context)}}\+:
\begin{DoxyItemize}
\item Manages interaction with the SQL Server database, including storing and retrieving country data.
\end{DoxyItemize}
\item {\bfseries{IMemory\+Cache / Custom\+Memory\+Cache}}\+:
\begin{DoxyItemize}
\item Caches country data to improve performance and reduce redundant calls to the external API.
\end{DoxyItemize}
\item {\bfseries{Api\+Settings}}\+:
\begin{DoxyItemize}
\item Contains the configuration for the external API URL.
\end{DoxyItemize}
\end{DoxyEnumerate}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md28}{}\doxysection{\texorpdfstring{Usage \& Workflow}{Usage \& Workflow}}\label{md__r_e_a_d_m_e_autotoc_md28}

\begin{DoxyEnumerate}
\item {\bfseries{Initialization}}\+:
\begin{DoxyItemize}
\item When the application starts, the necessary services ({\ttfamily Db\+Context}, {\ttfamily Custom\+Memory\+Cache}, and {\ttfamily Country\+Helper}) are registered in the dependency injection container.
\item The API controller ({\ttfamily Country\+Controller}) is ready to handle incoming HTTP requests.
\end{DoxyItemize}
\item {\bfseries{Fetching Country Data}}\+:
\begin{DoxyItemize}
\item On a request to {\ttfamily GET /api/country}, the {\ttfamily Country\+Controller} will check the cache for the data.
\item If the cache is empty, it will call {\ttfamily Country\+Helper.\+Fetch\+Countries\+Async()}, which will fetch data from the external API, store it in the database and cache, and return the result.
\end{DoxyItemize}
\item {\bfseries{Caching}}\+:
\begin{DoxyItemize}
\item If data is already in the cache, the cached data is returned immediately, reducing the need for API calls and improving performance.
\end{DoxyItemize}
\item {\bfseries{Database}}\+:
\begin{DoxyItemize}
\item Data fetched from the API is saved to the database for later use. The database acts as the persistent storage for the country data.
\end{DoxyItemize}
\end{DoxyEnumerate}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md30}{}\doxysection{\texorpdfstring{Testing the API with Postman}{Testing the API with Postman}}\label{md__r_e_a_d_m_e_autotoc_md30}
To test the API using Postman, follow these steps\+:


\begin{DoxyEnumerate}
\item Open Postman and set the request type to {\ttfamily GET}.
\item Set the URL to {\ttfamily \href{http://localhost:5000/api/country}{\texttt{ http\+://localhost\+:5000/api/country}}} (or the appropriate URL based on your server configuration).
\item Send the request and inspect the response. You should receive a list of countries with their names, borders, and capitals.
\end{DoxyEnumerate}

\DoxyHorRuler{0}
\hypertarget{md__r_e_a_d_m_e_autotoc_md32}{}\doxysection{\texorpdfstring{Conclusion}{Conclusion}}\label{md__r_e_a_d_m_e_autotoc_md32}
This API provides a simple and efficient way to fetch and cache country information. By leveraging external APIs, a custom caching mechanism, and a local SQL Server database, the API ensures that requests are handled efficiently and consistently. 